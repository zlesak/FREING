<section class="page supplier-create">
  <mat-card class="card">
    <mat-card-header>
      <h2>{{ editMode() ? 'Upravit dodavatele' : 'Nový dodavatel' }}</h2>
    </mat-card-header>
    <mat-card-content>
      @if (error) {
        <div class="alert error">{{ error }}</div>
      }
      @if (success) {
        <div class="alert success">{{ success }}</div>
      }
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="form-section-header">
          <h3>Základní údaje</h3>
        </div>
        <div class="grid">
          <mat-form-field>
            <mat-label>Obchodní jméno</mat-label>
            <input matInput formControlName="tradeName" placeholder="Např. ABC s.r.o.">
            @if (form.get('tradeName')?.hasError('required') && form.get('tradeName')?.touched) {
              <mat-error>Obchodní jméno je povinné</mat-error>
            }
            @if (form.get('tradeName')?.hasError('minlength') && form.get('tradeName')?.touched) {
              <mat-error>Obchodní jméno musí mít alespoň 2 znaky</mat-error>
            }
          </mat-form-field>
        </div>
        <div class="form-section-header">
          <h3>Kontaktní údaje</h3>
        </div>
        <div class="grid">
          <mat-form-field>
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" placeholder="info@firma.cz">
            @if (form.get('email')?.hasError('required') && form.get('email')?.touched) {
              <mat-error>Email je povinný</mat-error>
            }
            @if (form.get('email')?.hasError('email') && form.get('email')?.touched) {
              <mat-error>Neplatný formát emailu</mat-error>
            }
          </mat-form-field>
          <mat-form-field>
            <mat-label>Telefon</mat-label>
            <input matInput formControlName="phoneNumber" placeholder="+420 123 456 789">
            @if (form.get('phoneNumber')?.hasError('required') && form.get('phoneNumber')?.touched) {
              <mat-error>Telefon je povinný</mat-error>
            }
          </mat-form-field>
        </div>
        <div class="form-section-header">
          <h3>Adresa</h3>
        </div>
        <div class="grid">
          <mat-form-field>
            <mat-label>Ulice</mat-label>
            <input matInput formControlName="street" placeholder="Hlavní">
            @if (form.get('street')?.hasError('required') && form.get('street')?.touched) {
              <mat-error>Ulice je povinná</mat-error>
            }
          </mat-form-field>
          <mat-form-field>
            <mat-label>Číslo popisné</mat-label>
            <input matInput formControlName="houseNumber" placeholder="123">
            @if (form.get('houseNumber')?.hasError('required') && form.get('houseNumber')?.touched) {
              <mat-error>Číslo popisné je povinné</mat-error>
            }
          </mat-form-field>
          <mat-form-field>
            <mat-label>Město</mat-label>
            <input matInput formControlName="city" placeholder="Praha">
            @if (form.get('city')?.hasError('required') && form.get('city')?.touched) {
              <mat-error>Město je povinné</mat-error>
            }
          </mat-form-field>
          <mat-form-field>
            <mat-label>PSČ</mat-label>
            <input matInput formControlName="zip" placeholder="110 00">
            @if (form.get('zip')?.hasError('required') && form.get('zip')?.touched) {
              <mat-error>PSČ je povinné</mat-error>
            }
          </mat-form-field>
          <mat-form-field>
            <mat-label>Země</mat-label>
            <input matInput formControlName="country" placeholder="Česká republika">
            @if (form.get('country')?.hasError('required') && form.get('country')?.touched) {
              <mat-error>Země je povinná</mat-error>
            }
          </mat-form-field>
        </div>
        <div class="form-section-header">
          <h3>Fakturační údaje a bankovní spojení</h3>
        </div>
        <div class="grid">
          <mat-form-field>
            <mat-label>IČO</mat-label>
            <input matInput formControlName="ico" placeholder="12345678">
          </mat-form-field>
          <mat-form-field>
            <mat-label>DIČ</mat-label>
            <input matInput formControlName="dic" placeholder="CZ12345678">
          </mat-form-field>
          <mat-form-field>
            <mat-label>Číslo účtu</mat-label>
            <input matInput formControlName="bankAccount" placeholder="123456789">
          </mat-form-field>
          <mat-form-field>
            <mat-label>Kód banky</mat-label>
            <input matInput formControlName="bankCode" placeholder="0100">
          </mat-form-field>
          <mat-form-field>
            <mat-label>Měna</mat-label>
            <mat-select formControlName="currency">
              @for (curr of currencyOptions; track curr) {
                <mat-option [value]="curr">{{ curr }}</mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>
        <div class="actions">
          <button mat-button type="button" (click)="cancel()" [disabled]="submitting">
            <mat-icon>cancel</mat-icon>
            Zrušit
          </button>
          <button mat-raised-button color="primary" type="submit" [disabled]="submitting || form.invalid">
            <mat-icon>save</mat-icon>
            {{ editMode() ? 'Uložit změny' : 'Vytvořit' }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</section>
